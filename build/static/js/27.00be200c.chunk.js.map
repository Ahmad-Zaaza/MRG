{"version":3,"sources":["pages/SearchResultsMobile.js"],"names":["SearchResultsMobile","query","useParams","useIntl","locale","formatMessage","React","useState","brandFilters","setBrandFilters","value","label","sortBy","setSortBy","page","setPage","filtersApplied","setFiltersApplied","priceFilters","setPriceFilters","filters","setFilters","resultsPerPage","setResultsPerPage","cartMenuOpen","setCartMenuOpen","sortByOpen","setSortByOpen","filtersOpen","setFiltersOpen","useInView","triggerRef","inView","useQuery","searchProducts","retry","refetchOnWindowFocus","data","productsLoading","isLoading","search","filterProducts","enabled","filteredData","filteredProductsLoading","useEffect","length","className","key","setSideMenuOpen","div","initial","opacity","animate","exit","onClick","products","id","resolvePlural","layout","h1","map","item","button","type","prev","filter","i","filteredProducts","handleBrandChange","brand","newArr","push","handleSortByChange","selectedValue","handleChangePriceInput","e","target","handlePriceChange","values","handleSubmitPrice","handleResultPerPageChange"],"mappings":"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","file":"static/js/27.00be200c.chunk.js","sourcesContent":["import React from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { useQuery } from 'react-query';\r\nimport { useParams } from 'react-router-dom';\r\nimport CategoryMobileItemGrid from '../components/CategoryMobile/CategoryMobileItemGrid';\r\nimport SortInfoPanelMobile from '../components/CategoryMobile/SortInfoPanelMobile';\r\nimport Layout from '../components/Layout';\r\nimport { filterProducts, searchProducts } from '../Queries/Queries';\r\nimport { AnimatePresence, AnimateSharedLayout, motion } from 'framer-motion';\r\nimport SideCartMenuMobile from '../components/SingleProductMobile/SideCartMenuItemMobile';\r\nimport { useInView } from 'react-intersection-observer';\r\n\r\nexport default function SearchResultsMobile() {\r\n  const { query } = useParams();\r\n  const { locale, formatMessage } = useIntl();\r\n  const [brandFilters, setBrandFilters] = React.useState(null);\r\n  const [sortBy, setSortBy] = React.useState({\r\n    value: 'newest',\r\n    label: 'Newest',\r\n  });\r\n  const [page, setPage] = React.useState(1);\r\n\r\n  const [filtersApplied, setFiltersApplied] = React.useState(false);\r\n  const [priceFilters, setPriceFilters] = React.useState([10000]);\r\n  const [filters, setFilters] = React.useState([]);\r\n  const [resultsPerPage, setResultsPerPage] = React.useState(10);\r\n  const [cartMenuOpen, setCartMenuOpen] = React.useState(false);\r\n  const [sortByOpen, setSortByOpen] = React.useState(false);\r\n  const [filtersOpen, setFiltersOpen] = React.useState(false);\r\n  const [triggerRef, inView] = useInView();\r\n\r\n  const { data, isLoading: productsLoading } = useQuery(\r\n    ['searchProducts', query, page, resultsPerPage],\r\n    searchProducts,\r\n    { retry: true, refetchOnWindowFocus: false }\r\n  );\r\n\r\n  const { filteredData, isLoading: filteredProductsLoading } = useQuery(\r\n    [\r\n      'filtered-products',\r\n      {\r\n        search: query,\r\n        brandFilters,\r\n        sortBy,\r\n        page,\r\n        resultsPerPage,\r\n        locale,\r\n        priceFilters,\r\n      },\r\n    ],\r\n    filterProducts,\r\n    { retry: true, refetchOnWindowFocus: false, enabled: filtersApplied }\r\n  );\r\n\r\n  const handleResultPerPageChange = selectedValue => {\r\n    setResultsPerPage(selectedValue);\r\n  };\r\n  const handleRemoveFilters = type => {\r\n    setFilters(prev => {\r\n      return prev.filter(i => i.type !== type);\r\n    });\r\n    if (type === 'Brand') {\r\n      setBrandFilters(null);\r\n    }\r\n    if (type === 'Sort') {\r\n      setSortBy({\r\n        value: 'newest',\r\n        label: 'Newest',\r\n      });\r\n    }\r\n    if (type === 'Price') {\r\n      setFilters(prev => {\r\n        return prev.filter(i => i.type !== 'Price');\r\n      });\r\n    }\r\n  };\r\n\r\n  const handlePriceChange = values => {\r\n    setPriceFilters(values);\r\n  };\r\n  const handleChangePriceInput = e => {\r\n    if (e.target.value < 0) return;\r\n    if (e.target.value > 10000) return;\r\n    setPriceFilters([e.target.value]);\r\n  };\r\n  const handleSubmitPrice = () => {\r\n    setFilters(prev => {\r\n      let newArr = prev.filter(i => i.type !== 'Price');\r\n      newArr.push({ type: 'Price', value: `Max ${priceFilters[0]}` });\r\n      return newArr;\r\n    });\r\n  };\r\n\r\n  const handleSortByChange = selectedValue => {\r\n    if (selectedValue.value === 'newest') {\r\n      setFilters(prev => {\r\n        return prev.filter(i => i.type !== 'Sort');\r\n      });\r\n      setSortBy(selectedValue);\r\n      return;\r\n    }\r\n    setFilters(prev => {\r\n      let newArr = prev.filter(i => i.type !== 'Sort');\r\n      newArr.push({ type: 'Sort', value: selectedValue.label });\r\n      return newArr;\r\n    });\r\n    setSortBy(selectedValue);\r\n  };\r\n  const handleBrandChange = brand => {\r\n    if (brandFilters === brand) {\r\n      setBrandFilters(null);\r\n      setFilters(prev => {\r\n        return prev.filter(i => i.type !== 'Brand');\r\n      });\r\n    } else {\r\n      setFilters(prev => {\r\n        let newArr = prev.filter(i => i.type !== 'Brand');\r\n        newArr.push({ type: 'Brand', value: brand });\r\n\r\n        return newArr;\r\n      });\r\n      setBrandFilters(brand);\r\n    }\r\n  };\r\n  React.useEffect(() => {\r\n    if (filters.length === 0) {\r\n      setFiltersApplied(false);\r\n    } else {\r\n      setFiltersApplied(true);\r\n    }\r\n  }, [filters]);\r\n  const resolvePlural = () => {\r\n    switch (data?.products.length) {\r\n      case 1:\r\n        return formatMessage({ id: 'one-search-results' });\r\n\r\n      case 2:\r\n        return formatMessage({ id: 'two-search-results' });\r\n\r\n      case data?.products.length > 10:\r\n        return formatMessage({ id: 'more-than-10-search-results' });\r\n      default:\r\n        return formatMessage({ id: 'search-results' });\r\n    }\r\n  };\r\n  return (\r\n    <Layout>\r\n      <div className=\"min-h-screen relative\">\r\n        <AnimatePresence>\r\n          {cartMenuOpen && (\r\n            <SideCartMenuMobile\r\n              key=\"side-cart\"\r\n              setSideMenuOpen={setCartMenuOpen}\r\n            />\r\n          )}\r\n          {cartMenuOpen && (\r\n            <motion.div\r\n              key=\"sidecart-bg\"\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 0.5 }}\r\n              exit={{ opacity: 0 }}\r\n              onClick={() => setCartMenuOpen(false)}\r\n              className=\"side__addCart-bg\"\r\n            ></motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n        {data?.products && (\r\n          <div className=\"p-3 text-lg border-b\">\r\n            <h1>\r\n              {data?.products.length > 2 && data?.products.length}{' '}\r\n              {resolvePlural()} <strong>{query}</strong>\r\n            </h1>\r\n          </div>\r\n        )}\r\n        <AnimateSharedLayout>\r\n          <motion.div layout className=\"px-3\">\r\n            {filters.length !== 0 && (\r\n              <>\r\n                <motion.h1 layout className=\"text-lg mb-2 font-semibold\">\r\n                  {formatMessage({ id: 'filtered-by' })} :\r\n                </motion.h1>\r\n                <motion.div layout className=\"flex items-center\">\r\n                  {filters.map(item => {\r\n                    return (\r\n                      <motion.button\r\n                        layout\r\n                        className=\"mx-1 py-1 px-3 bg-main-color text-main-text rounded-full\"\r\n                        key={item.value}\r\n                        onClick={() => handleRemoveFilters(item.type)}\r\n                      >\r\n                        {formatMessage({ id: item.type })} :{' '}\r\n                        {formatMessage({ id: item.value })}\r\n                      </motion.button>\r\n                    );\r\n                  })}\r\n                </motion.div>\r\n                <hr className=\"my-3\" />\r\n              </>\r\n            )}\r\n          </motion.div>\r\n        </AnimateSharedLayout>\r\n\r\n        <CategoryMobileItemGrid\r\n          products={data?.products}\r\n          productsLoading={productsLoading}\r\n          setCartMenuOpen={setCartMenuOpen}\r\n          filteredProducts={filteredData?.filteredProducts}\r\n          filteredProductsLoading={filteredProductsLoading}\r\n          triggerRef={triggerRef}\r\n          setPage={setPage}\r\n        />\r\n        <AnimatePresence>\r\n          {inView && (\r\n            <SortInfoPanelMobile\r\n              productsLoading={productsLoading}\r\n              products={data?.products}\r\n              brandFilters={brandFilters}\r\n              handleBrandChange={handleBrandChange}\r\n              filtersApplied={filtersApplied}\r\n              setSortByOpen={setSortByOpen}\r\n              setFiltersOpen={setFiltersOpen}\r\n              filtersOpen={filtersOpen}\r\n              sortByOpen={sortByOpen}\r\n              sortBy={sortBy}\r\n              handleSortByChange={handleSortByChange}\r\n              handleChangePriceInput={handleChangePriceInput}\r\n              handlePriceChange={handlePriceChange}\r\n              handleSubmitPrice={handleSubmitPrice}\r\n              priceFilters={priceFilters}\r\n              handleResultPerPageChange={handleResultPerPageChange}\r\n            />\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n    </Layout>\r\n  );\r\n}\r\n"],"sourceRoot":""}